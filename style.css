
@import url('https://fonts.googleapis.com/css2?family=Caveat:wght@700&display=swap');

:root{
    --color-background-primary: #0a0a0a;
    --color-widget-bg: #ffffff;
    --color-text-primary: #111;
    --color-text-secondary: #555;
    --color-accent-solar: #ff6b00;
    --color-accent-grid: #00aaff;
    --color-chart-fill: #dedede;

    --header-height: 72px;
    --card-radius: 14px;
    --gap: 0.3rem;
  }

  *{box-sizing:border-box}
  html,body{height:100%; margin:0; font-family:'Inter',Roboto,sans-serif; scroll-behavior:smooth; background:var(--color-background-primary); color:#fff;}
  main{padding-top: calc(var(--header-height)+16px);}

  /* Header */
  .site-header{position:fixed; top:0; left:0; right:0; height: var(--header-height); display:flex; align-items:center; padding:0 28px; background: rgba(10,10,10,0.95); box-shadow:0 2px 14px rgba(0,0,0,0.7); z-index:200;}
  .logo-user{display:flex; align-items:center; gap:12px;}
  .logo-img{height:70px; width:auto; transition: transform .25s;}
  .logo-img:hover{transform:scale(1.07);}
  .username{font-weight:600; color:#fff; font-size:16px;}
  .main-nav{position:absolute; left:50%; transform:translateX(-50%); display:flex; gap:6px; background: rgba(255,255,255,0.06); padding:6px 10px; border-radius:10px; backdrop-filter:blur(6px);}
  .main-nav button{background:transparent; border:none; color:#fff; padding:8px 14px; border-radius:8px; font-weight:600; cursor:pointer; transition: background .25s ease, transform .2s ease;}
  .main-nav button.active, .main-nav button:hover{background: rgba(255,255,255,0.15); transform: translateY(-2px);}

  /* Visual Area */
  .visual-area{padding:28px; max-width:1400px; margin:auto;}
  .visual-header{display:flex; gap:16px; margin-bottom:12px;}
  .visual-header h1{margin:0; font-size:22px; font-weight:700;}
  .site-id{color:#ccc; font-size:13px;}
  .visual-stage{position:relative; background:#111; border-radius:var(--card-radius); padding:28px; min-height:320px; display:flex; align-items:center; justify-content:center; box-shadow:0 6px 22px rgba(0,0,0,0.6); transition:box-shadow .3s;}
  .panel-3d{width:70%; height:220px; background:linear-gradient(135deg,#181818,#0d0d0d); border-radius:10px; display:flex; justify-content:center; align-items:center; color:#888; font-size:14px;}
  .visual-controls{position:absolute; right:12px; top:50%; transform:translateY(-50%); display:flex; flex-direction:column; gap:8px;}
  .visual-controls .ctrl{background: rgba(255,255,255,0.15); border:none; width:44px; height:44px; border-radius:8px; color:#fff; font-size:20px; cursor:pointer;}

  /* Data Grid */
  .data-grid-container{display:grid; grid-template-columns:repeat(4,1fr); gap:var(--gap); padding:2rem; max-width:1400px; margin:auto;}
  @media(max-width:1024px){.data-grid-container{grid-template-columns:repeat(2,1fr);}}
  @media(max-width:480px){.data-grid-container{grid-template-columns:1fr; padding:1rem;}}

  /* Data Cards */
  .data-card{background:#fff; color:#111; border-radius:var(--card-radius); padding:16px; box-shadow:0 8px 20px rgba(0,0,0,0.35); display:flex; flex-direction:column; transition:transform .28s ease, box-shadow .28s ease, opacity .28s ease; cursor:pointer;}
  .data-card:hover{transform:translateY(-6px); box-shadow:0 20px 45px rgba(0,0,0,0.5);}
  .data-card.selected { transform: scale(0.95) translateY(5px); box-shadow: 0 2px 8px rgba(0,0,0,0.2); opacity: 0.8;}
  .card-top{display:flex; justify-content:space-between; align-items:center;}
  .card-top h3{font-size:14px; font-weight:700; margin:0;}
  .metric{font-size:28px; font-weight:800; margin:8px 0;}
  .breakdown{display:flex; justify-content:space-between; font-size:13px; color:#666;}
  .mini-chart{height:40px; background:#ebebeb; border-radius:8px; color:#666; display:flex; align-items:center; justify-content:center;}
  .progress-bar{background:#e0e0e0; height:12px; border-radius:6px; overflow:hidden; margin:8px 0;}
  .progress{height:100%; background:var(--color-accent-solar);}
  .progress-label{font-size:12px; color:#444;}

  /* Overlay Popups */
  .card-overlay{position:fixed; inset:0; background:rgba(0,0,0,0.55); backdrop-filter:blur(6px); z-index:300; display: none;}
  .card-overlay.active{display: block;}
  .popup-card{position: absolute; background:#fff; border-radius:14px; padding:18px; color:#111; opacity: 0; pointer-events: none; transition: transform 0.35s ease, opacity 0.35s ease, width 0.35s ease, height 0.35s ease, top 0.35s ease, left 0.35s ease;}
  .popup-card.expanded{opacity:1; pointer-events: auto;}
  .closePopup{position:absolute; top:14px; right:14px; font-size:20px; background:none; border:none; cursor:pointer;}

  .panel-3d {
    width: 70%;
    height: 220px;
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    padding: 0;

    /* remove shadow completely */
    box-shadow: none;
  }

  .panel-3d .panel-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;            /* removes small gaps caused by inline images */
    border-radius: 0;          /* already handled by parent */
  }

  #connectBtn {
    background: rgba(255, 255, 255, 0.06);
    color: #fff;
    border: none;
    padding: 8px 16px;
    border-radius: 50px; /* rounded pill */
    font-weight: 600;
    cursor: pointer;
    transition: background 0.25s ease, transform 0.2s ease;
  }

  #connectBtn:hover {
    background: rgba(2, 38, 216, 0.15);
    transform: translateY(-2px);
  }

  .header-right {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 16px; /* space between username and button */
  }

  .username-btn {
    background: rgba(255,255,255,0.06);
    border: none;
    color: #fff;
    padding: 6px 12px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.25s ease, transform 0.2s ease;
  }

  .username-btn:hover {
    background: rgba(255,255,255,0.15);
    transform: translateY(-1px);
  }
  .username-text {
    color: #fff;
    font-weight:600;
    cursor: pointer;
    transition: color 0.2s ease;
  }

  .username-text:hover {
    color: var(--color-accent-grid);
  }

  /* Username overlay adjustments */
  #usernameOverlay .popup-card {
    background: #111; /* dark background */
    color: #fff;      /* white text */
    width: 320px;     /* smaller centered box */
    padding: 24px;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    transform: scale(0.9);
    opacity: 0;
    transition: all 0.26s ease;
  }

  /* Expand when active */
  #usernameOverlay.active .popup-card,
  #usernameOverlay .popup-card.expanded {
    transform: scale(1);
    opacity: 1;
  }

  /* Input styling */
  #usernameOverlay input {
    width: 100%;
    padding: 8px 10px;
    margin-top: 12px;
    border-radius: 6px;
    border: 1px solid #555;
    background: #222;
    color: #fff;
    font-size: 14px;
    text-align: center;
  }

  /* Save button styling */
  #usernameOverlay button#saveUsername {
    margin-top: 12px;
    padding: 8px 14px;
    border: none;
    background: var(--color-accent-grid);
    color: #111;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
  }
  #usernameOverlay button#saveUsername {
  background: var(--color-accent-grid) !important; /* force it blue */
  color: #111;
}


  /* Close button */
  #usernameOverlay .closePopup {
    position: absolute;
    top: 12px;
    right: 12px;
    color: #fff;
    background: transparent;
    border: none;
    font-size: 20px;
    cursor: pointer;
  }

  /* Center the overlay flex container */
  #usernameOverlay {
    display: none; /* hidden by default */
    justify-content: center;
    align-items: center;
  }
  #usernameOverlay.active {
    display: flex;
  }

/* New Card Styles */
.metric-large {
  font-size: 2.5rem;
  font-weight: 300;
  text-align: center;
  margin: 1rem 0;
}

.handwritten {
  font-family: 'Caveat', cursive; /* Needs a handwritten font, add to HTML head */
  font-weight: 700;
}

.card-footer {
  display: flex;
  justify-content: space-around;
  font-size: 0.9rem;
}

.trend {
  font-weight: 600;
}

.trend.up {
  color: #28a745;
}

.trend.down {
  color: #dc3545;
}

.chart-container {
  flex-grow: 1;
  display: flex;
  width: 100%;
}

.progress-group {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.progress-item {
  display: grid;
  grid-template-columns: 80px 1fr 80px;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.8rem;
}

.progress-item label {
  font-weight: 600;
}

.progress-bar-wrapper {
  background-color: #e9ecef;
  border-radius: 0.25rem;
  height: 10px;
  overflow: hidden;
}

.progress-bar-inner {
  background-color: #28a745;
  height: 100%;
  border-radius: 0.25rem;
}

.card-content-icon {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
}

.battery-icon {
  width: 36px;
  height: 20px;
  border: 2px solid #111; /* outline of battery */
  border-radius: 2px;
  position: relative;
  background-color: #00b894; /* fill color for full battery */
}
.battery-icon::after {
  content: '';
  position: absolute;
  top: 50%;
  right: -4px;
  transform: translateY(-50%);
  width: 4px;
  height: 8px;
  background: #111;
  border-radius: 1px;
}



.dual-metrics {
  display: flex;
  justify-content: space-around;
  text-align: center;
}

.metric-item h4 {
  font-size: 0.9rem;
  margin-bottom: 0.5rem;
  color: #555;
}

.metric-value {
  font-size: 1.5rem;
  font-weight: 700;
}

.unit {
  font-size: 1rem;
  font-weight: 400;
}

.lightning-icon {
  /* Simple CSS lightning icon */
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-bottom: 20px solid var(--color-accent-solar);
  transform: rotate(35deg);
  margin: 0 auto;
}

.chart-row {
    display: flex;
    gap: 1rem;
    align-items: center;
}

#stored-used-card {
  grid-column-start: 4;
}

#energy-per-step-card {
  grid-column: span 2;
}

/* Make power generated and weekly average cards taller on desktop */
@media(min-width: 1025px) {
  #power-generated-card,
  #weekly-average-card {
    grid-row: span 2;
  }
}

@media(max-width:1024px){
  #stored-used-card {
    grid-column-start: 2;
  }
}

@media(max-width:480px){
  #stored-used-card {
    grid-column-start: 1;
  }
}